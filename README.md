# Dune: Awakening Crafting API

![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)
![Framework](https://img.shields.io/badge/Framework-FastAPI-green.svg)
![License](https://img.shields.io/badge/License-PolyForm%20Noncommercial-lightgrey.svg)

A lightweight, super-fast, and easy-to-maintain RESTful API for serving craftable item data from the game *Dune: Awakening*. Built with FastAPI and SQLite, this API is designed for high performance and simple deployment, allowing others to easily build applications like crafting calculators, wikis, or Discord bots.

## API Documentation

- **Swagger**: [SWAGGER](https://dune-awakening-api.onrender.com/docs)
- **ReDoc**: [REDOC](https://dune-awakening-api.onrender.com/redoc)
- **OpenAPI**: [OPENAPI](https://dune-awakening-api.onrender.com/openapi)

## Features

-   **Fast & Lightweight**: Built on FastAPI and Uvicorn for asynchronous speed.
-   **Simple Database**: Uses SQLite for zero-configuration, file-based persistence.
-   **Data-Driven**: All item data is managed in a simple `items_data.json` file. No code changes are needed to add or edit items.
-   **Dynamic Calculations**: Automatically calculates special costs, like the "Deep Desert" cost (halved, rounding up).
-   **Comprehensive Data**: Tracks power consumption for buildings/vehicles and power generation for power plants.
-   **Abuse Prevention**: Built-in IP-based rate limiting to prevent spam.
-   **Automatic Docs**: Instant, interactive API documentation (Swagger UI and ReDoc) generated by FastAPI.

## Technology Stack

-   **Backend**: [FastAPI](https://fastapi.tiangolo.com/)
-   **Database**: [SQLite](https://www.sqlite.org/index.html) (via [SQLModel](https://sqlmodel.tiangolo.com/))
-   **Server**: [Uvicorn](https://www.uvicorn.org/)
-   **Rate Limiting**: [slowapi](https://github.com/laurents/slowapi)

---

## Getting Started (for Developers)

Follow these instructions to get a local copy up and running for development.

### Prerequisites

-   Python 3.8+
-   `pip` (Python package installer)

### Installation

1.  **Clone the repository:**
    ```sh
    git clone https://your-repository-url/dune-awakening-api.git
    cd dune-awakening-api
    ```

2.  **Create and activate a virtual environment:**
    -   **On macOS/Linux:**
        ```sh
        python3 -m venv .venv
        source .venv/bin/activate
        ```
    -   **On Windows:**
        ```sh
        python -m venv .venv
        .venv\Scripts\activate
        ```

3.  **Create a `requirements.txt` file:**
    If you don't have one yet, create it by running this command in your activated virtual environment:
    ```sh
    pip freeze > requirements.txt
    ```

4.  **Install the required packages:**
    ```sh
    pip install -r requirements.txt
    ```

### Running the API

1.  **Start the server:**
    ```sh
    uvicorn main:app --reload
    ```
    -   `main`: The file `main.py`.
    -   `app`: The `FastAPI()` object inside `main.py`.
    -   `--reload`: The server will automatically restart when you make code changes.

2.  The API will now be running at `http://127.0.0.1:8000`.

---

## API Documentation

This API provides a set of endpoints to retrieve information about craftable items.

### Interactive Docs

For a full, interactive API documentation, run the server and navigate to:
-   **Swagger UI**: `http://127.0.0.1:8000/docs`
-   **ReDoc**: `http://127.0.0.1:8000/redoc`

### Rate Limiting

To prevent abuse, the API enforces rate limits based on IP address. If you exceed the limit, you will receive a `429 Too Many Requests` error. The default limits are:
-   **/api/v1/items**: 20 requests per minute
-   **/api/v1/items/{item_id}**: 60 requests per minute
-   **/api/v1/items/search/**: 10 requests per minute

### Endpoints

#### 1. Get All Craftable Items

-   **URL**: `/api/v1/items`
-   **Method**: `GET`
-   **Description**: Retrieves a list of all items in the database.
-   **Example Response**:
    ```json
    [
      {
        "id": 1,
        "name": "Makeshift Shiv",
        "description": "A crude but effective short blade.",
        "item_type": "Weapon",
        "power_consumption": 0,
        "power_generation": 0,
        "crafting_materials": [
          { "item_name": "Salvaged Metal", "quantity": 5 },
          { "item_name": "Plant Fiber", "quantity": 2 }
        ],
        "deep_desert_materials": [
          { "item_name": "Salvaged Metal", "quantity": 3 },
          { "item_name": "Plant Fiber", "quantity": 1 }
        ]
      }
    ]
    ```

#### 2. Get a Specific Item by ID

-   **URL**: `/api/v1/items/{item_id}`
-   **Method**: `GET`
-   **Description**: Retrieves a single item by its unique ID.
-   **Example Response** (`/api/v1/items/3`):
    ```json
    {
      "id": 3,
      "name": "Small Wind Turbine",
      "description": "Generates a steady supply of power from desert winds.",
      "item_type": "Building",
      "power_consumption": 0,
      "power_generation": 100,
      "crafting_materials": [
        { "item_name": "Steel Girders", "quantity": 5 },
        { "item_name": "Turbine Blades", "quantity": 2 }
      ],
      "deep_desert_materials": [
        { "item_name": "Steel Girders", "quantity": 3 },
        { "item_name": "Turbine Blades", "quantity": 1 }
      ]
    }
    ```

#### 3. Search for Items by Name

-   **URL**: `/api/v1/items/search/`
-   **Method**: `GET`
-   **Description**: Searches for items where the name contains the query string (case-insensitive).
-   **Query Parameter**: `name` (e.g., `/api/v1/items/search/?name=turbine`)
-   **Example Response**:
    ```json
    [
      {
        "id": 3,
        "name": "Small Wind Turbine",
        "description": "Generates a steady supply of power from desert winds.",
        "item_type": "Building",
        "power_consumption": 0,
        "power_generation": 100,
        "crafting_materials": [
          { "item_name": "Steel Girders", "quantity": 5 },
          { "item_name": "Turbine Blades", "quantity": 2 }
        ],
        "deep_desert_materials": [
          { "item_name": "Steel Girders", "quantity": 3 },
          { "item_name": "Turbine Blades", "quantity": 1 }
        ]
      }
    ]
    ```

---

## How to Add or Modify Items

This project is designed to be easily updated without touching any Python code.

1.  **Edit the Data File**: Open `items_data.json`.
2.  **Add/Modify Data**: Add a new JSON object to the list or edit an existing one. Follow the structure of the existing items. Each item must have `name`, `description`, `item_type`, `power_consumption`, `power_generation`, and `crafting_materials`.
3.  **Restart the API with a Clean Database**: To force the API to load your new data, you must start with a clean database.
    -   Stop the running server (`Ctrl+C`).
    -   **Delete the `dune_crafting.db` file.**
    -   Restart the server: `uvicorn main:app --reload`.

The API will automatically create a new database and populate it with the updated contents of `items_data.json`.

## License

This project is licensed under the PolyForm Noncommercial License 1.0.0.
  
You may use, modify, and contribute to this project for noncommercial purposes only. Commercial use requires explicit permission from the author.
  
See [LICENSE](./LICENSE) for full details.
